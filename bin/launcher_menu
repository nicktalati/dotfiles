#!/usr/bin/env bash
set -euo pipefail


menu() {
  printf '%s\n' \
    "Thunderbird | Teams" \
    "Whatsapp | Voice"
}

spawn_thunderbird_teams() {
  thunderbird >/dev/null 2>&1 & disown
  sleep 0.8
  swaymsg 'mark thunderbird'
  swaymsg 'split h'
  firefox -P workfs --new-window "teams.microsoft.com/v2" >/dev/null 2>&1 & disown
  sleep 0.8
  swaymsg '[con_mark="thunderbird"] focus; resize shrink width 8 ppt'
}

spawn_whatsapp_voice() {
  firefox -P personalfs --new-window "web.whatsapp.com" >/dev/null 2>&1 & disown
  sleep 0.8
  swaymsg 'split h'
  firefox -P personalfs --new-window "voice.google.com" >/dev/null 2>&1 & disown
}

choice="$(menu | wofi)"
case "$choice" in
  "Thunderbird | Teams")
    spawn_thunderbird_teams
    ;;
  "Whatsapp | Voice")
    spawn_whatsapp_voice
    ;;
  *) exit 0 ;;
esac
